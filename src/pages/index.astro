---
import MainLayout from "../layouts/MainLayout.astro";
import BlogCard from "../components/BlogCard.astro";
import { getCollection } from "astro:content";

// 获取所有博客文章并按日期排序
const posts = await getCollection("blog");

const sortedPosts = posts.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});

// 只显示最新的5篇文章
const latestPosts = sortedPosts.slice(0, 5);
---

<MainLayout title="欢迎来到我的博客">
  <section class="hero">
    <h2>文章</h2>
    <p>欢迎阅读我的最新技术分享和学习心得</p>
  </section>

  <section class="blog-list">
    {
      latestPosts.length > 0 ? (
        latestPosts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            date={post.data.date}
            slug={post.slug}
            tags={post.data.tags}
          />
        ))
      ) : (
        <div class="no-posts">
          <p>暂无博客文章，敬请期待！</p>
        </div>
      )
    }
  </section>

  <section class="view-all">
    <a href="/blog" class="btn">查看所有文章</a>
  </section>
</MainLayout>

<style>
  .hero {
    text-align: center;
    margin-bottom: 3rem;
    padding: 2rem 0;
  }

  .hero h2 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: var(--text-color);
  }

  .hero p {
    font-size: 1.2rem;
    color: var(--text-color-light);
  }

  .blog-list {
    max-width: 800px;
    margin: 0 auto;
  }

  .no-posts {
    text-align: center;
    padding: 3rem 0;
    color: var(--text-color-light);
    font-size: 1.1rem;
  }

  .view-all {
    text-align: center;
    margin-top: 2rem;
  }

  .btn {
    display: inline-block;
    background-color: var(--primary-color);
    color: #fff;
    padding: 0.8rem 1.5rem;
    border-radius: 4px;
    text-decoration: none;
    font-weight: 500;
    transition: background-color 0.3s ease;
  }

  .btn:hover {
    opacity: 0.9;
  }
</style>
